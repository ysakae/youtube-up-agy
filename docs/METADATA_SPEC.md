# メタデータ生成仕様 (Metadata Generation Spec)

`src/metadata.py` における、動画ファイルからのメタデータ（タイトル、説明、タグ、撮影情報）生成ルールについて記述します。

## 1. 概要

本ツールはユーザーの手入力を最小限にするため、**ファイルシステムの情報（パス、ファイル名）** と **動画ファイルの内部メタデータ（撮影日時）** を組み合わせて、YouTube アップロード用の情報を自動生成します。

## 2. 生成ルール

### 2.1 タイトル (Title)

フォルダ名をカテゴリとして扱い、ファイル名をコンテンツ名として結合します。

- **フォーマット**: `【{親フォルダ名}】{ファイル名(拡張子なし)}`
- **制約**: YouTube のタイトル制限（全角・半角問わず 100 文字）に収まるよう、超過する場合は末尾をトリミングして `...` を付与します。
- **例**:
  - パス: `Travel/Vlog2023/Beach.mp4`
  - 親フォルダ: `Vlog2023`
  - ファイル名: `Beach`
  - **生成タイトル**: `【Vlog2023】Beach`

### 2.2 説明文 (Description)

動画のコンテキスト情報とシステム情報を複数行で記述します。

- **フォーマット**:
  ```text
  {親フォルダ名}
  No. {現在のインデックス}/{総ファイル数}
  
  File: {ファイル名(拡張子あり)}
  Captured: {撮影日時 (YYYY-MM-DD HH:MM:SS) または Unknown}
  ```
- **例**:
  ```text
  Vlog2023
  No. 1/10
  
  File: Beach.mp4
  Captured: 2023-08-15 14:30:00
  ```

### 2.3 タグ (Tags)

検索性と管理のために自動でタグを付与します。

- **固定タグ**: `auto-upload`
- **動的タグ**:
  - `{親フォルダ名}`
  - `{撮影年}` (メタデータから取得できた場合)
- **例**: `["auto-upload", "Vlog2023", "2023"]`

### 2.4 撮影日時 (Recording Details)

YouTube 上で「撮影日」として表示されるフィールドを設定します。

- **取得元**: ファイル内部のメタデータ（`hachoir` ライブラリを使用し、`creation_date` を解析）。
- **API フィールド**: `recordingDetails.recordingDate`
- **フォーマット**: `YYYY-MM-DDThh:mm:ss.sZ` (ISO 8601 UTC)
- **注意**: ファイルメタデータが存在しない、または解析不能な場合は設定されません。

## 3. 実装詳細

`src.metadata.FileMetadataGenerator` クラスがこの責務を担います。
内部的に `hachoir` パーサーを使用し、エラー時はデフォルト値（日付なし等）にフォールバックします。
